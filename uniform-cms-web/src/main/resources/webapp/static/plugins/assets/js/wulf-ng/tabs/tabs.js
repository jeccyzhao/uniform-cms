!function(a){"function"==typeof define&&define.amd?define(["angular","../const/constants"],a):"object"==typeof module&&module.exports?module.exports=function(b,c){return void 0===c&&(c="undefined"!=typeof window?require("angular"):require("angular")(b)),a(c,require("../const/constants")),c}:a(angular)}(function(a){"use strict";var b=function(b,c){var d=null,e=this.panes=[],f=function(a,b){var c=e[d];return c.onDeselect({$event:b,$selectedIndex:a}),b&&b.isDefaultPrevented()?!1:(c.selected=!1,!0)},g=function(a,b){var c=e[a];c.onSelect({$event:b}),c.selected=!0,d=a},h=function(){for(var a=null,b=e.length,c=0;b>c;c++)if(!e[c].disable){a=e[c];break}return a},i=function(a){for(var b=null,c=e.length,d=0;c>d;d++)e[d]===a&&(b=d);return b};this.addPane=function(a){e.push(a);var b=e.length-1;d===b&&(a.selected=!0)},this.selectPane=function(a,b){var c=i(a);if(null!==c&&c!==d){if(a.disable)return;if(null!==d&&!f(c,b))return;g(c,b)}},this.removePane=function(a){var b=i(a);if(null!==b){var c=d;if(e.splice(b,1),b===c){d=null;var f=h();null!==f&&this.selectPane(f)}else c>b&&(d-=1)}},this.closePane=function(a,b){var c=i(a);null!==c&&(a.disable||a.onClose({$event:b,$closedIndex:c}))};var j=function(a){for(var b=i(a),c=e.length,d=null,f=++b;c>f;f++)if(!e[f].disable){d=f;break}return d},k=function(a){for(var b=i(a),c=null,d=--b;d>=0;d--)if(!e[d].disable){c=d;break}return c},l=function(b,c){var d=a.element(b.target).parent().parent();return d.find("li")[c].firstElementChild},m=function(a,b){var d=l(a,b);c(function(){d.focus()},0)};this.closeKeydown=function(a,c){var d=c.which;d===b.SPACE&&(this.closePane(a,c),c.preventDefault())},this.selectKeydown=function(c,d){var e;switch(d.which){case b.TAB:e=j(c),null===e&&a.element(d.target).parent().next().find("a").attr("tabIndex",-1);break;case b.SPACE:this.selectPane(c,d),d.preventDefault();break;case b.RIGHT:case b.DOWN:e=j(c),null!==e&&m(d,e),d.preventDefault();break;case b.LEFT:case b.UP:var f=k(c);null!==f&&m(d,f),d.preventDefault()}},this.$onInit=function(){d=a.isDefined(this.active)&&!isNaN(this.active)?this.active:0},this.$onChanges=function(a){if(a.active){var b=a.active.currentValue;if(b&&!isNaN(b)){var c=e[Number(b)];c&&this.selectPane(c)}}},this.$onDestroy=function(){this.destroyed=!0}};b.$inject=["WF-KEYCODE-CONST","$timeout"];var c=function(a){this.selected=!1,this.closeable=!!a.close,this.$onInit=function(){this.tabsCtrl.addPane(this)},this.$onDestroy=function(){this.tabsCtrl&&!this.tabsCtrl.destroyed&&this.tabsCtrl.removePane(this)}};c.$inject=["$attrs"],a.module("wf.angular.tabs",["wf.angular.constants"]).component("wfTabs",{transclude:!0,templateUrl:"wf/ng-template/tabs/tabs.html",bindings:{active:"<?"},controller:b}).component("wfPane",{transclude:!0,templateUrl:"wf/ng-template/tabs/pane.html",require:{tabsCtrl:"^wfTabs"},bindings:{label:"@",disable:"<?",onSelect:"&select",onDeselect:"&deselect",onClose:"&close"},controller:c})});