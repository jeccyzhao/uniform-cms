!function(a){"function"==typeof define&&define.amd?define(["angular","../const/constants"],a):"object"==typeof module&&module.exports?module.exports=function(b,c){return void 0===c&&(c="undefined"!=typeof window?require("angular"):require("angular")(b)),a(c,require("../const/constants")),c}:a(angular)}(function(a){"use strict";var b;b=function(a,b,c,d){this.isSelected=this.node.isSelected||!1,this.isExpend=this.node.isExpend||!1,this.node.isIndeterminate=this.node.isIndeterminate||!1,this.disable=this.disable||!1,this.nodeTypeClass=function(){return this.isLeafClass()?"tree-item":"tree-branch"},this.isBranch=function(){return this.isLeafClass()?"treeitem":"treebranch"},this.selectedClass=function(a){return this.parent.selectedNode===a?"tree-selected":""},this.hasCheckbox=function(){return this.parent.hasCheckbox},this.isNodeDisabled=function(){return this.parent.disable},this.isOpenClass=function(a){return a.isExpend?"tree-open":""},this.isChildrenShow=function(a){return a.isExpend},this.itemExpended=function(a,b){a.isExpend=!a.isExpend,b.stopPropagation()},this.selectCheckbox=function(a,b){switch(b.which){case d.SPACE:this.triggerNode(a),b.stopPropagation(),b.preventDefault()}},this.selectKeydown=function(a,b){if(this.disable)return-1;switch(b.which){case d.UP:case d.DOWN:this.parent.selectKeydown(a,b,b.which===d.DOWN),b.preventDefault();break;case d.TAB:var c=!b.shiftKey;this.parent.selectKeydown(a,b,c,!0);break;case d.SPACE:case d.ENTER:this.selectNode(a,b),b.preventDefault();break;case d.LEFT:a.isExpend=!1,b.preventDefault();break;case d.RIGHT:a.isExpend=!0,b.preventDefault()}},this.triggerNode=function(a){if(!this.disable){var b=a.isSelected,c=!b;this.parent.updateAllTree(a,c)}},this.selectNode=function(a,b){this.disable||(this.parent.selectedNode===a?this.parent.selectedNode=null:this.parent.selectedNode=a,b.stopPropagation())},this.isLeafClass=function(){return!(this.children&&0!==this.children.length)}},b.$inject=["$scope","$document","$element","WF-KEYCODE-CONST"];var c,d;c=function(b,c,e,f){function g(a,b,c,d){arguments.length>2&&"boolean"==typeof c&&(d=c,c={}),c=i.extend({},j,c),d=i.isDefined(d)?d:!0;var e=q(b),f=!0,g="id";h(a,c,function(a,j){var k=f&&(e?b===a[g]:b===a);if(k){f=!1;var l=d?o.bind(c):n.bind(c);h(a,c,l),i.forEach(j,p.bind(c))}return f})}function h(a,b,c){2===arguments.length&&i.isFunction(b)&&(c=b,b={}),b=i.extend({},j,b),c=c||i.noop;var d,e,f,g,h,k=[],l="children";for(i.isArray(a)?(i.forEach(a,function(a){k.push([a,[]])}),d=k.shift()):d=[a,[]];d;){if(e=d[0],f=d[1],c(e,f)!==!1&&e[l]&&i.isArray(e[l]))for(h=e[l].length,g=0;h>g;g++)k.push([e[l][g],[e].concat(f)]);d=k.shift()}}this.selectedNode=this.selectedNode||"",this.hasCheckbox=this.hasCheckbox||!1;var i=a,j=new f;d=!0;var k=function(b,e,f){var g=c.find("li")[b].firstElementChild.firstElementChild;return e&&!d&&f?(d=!d,a.element(g).find("input")[0]):(d=!d,g)};this.selectKeydown=function(a,b,c,d){var f=l(a,c,this.hasCheckbox,d);if(null!==f&&-1!==f){var g=k(f,this.hasCheckbox,d);e(function(){g.focus()},0)}};var l=function(a,b,e,f){var g,h=c.find("li"),i=m(h,a),j=h.length,k=null;return g=e&&!d&&f?i:b?++i:--i,j>g&&(k=g),k},m=function(a,b){for(var c=null,d=a.length,e=0;d>e;e++)a[e].id===b.title&&(c=e);return c};this.updateAllTree=function(a,b){g(this.treeData,a,b)};var n=function(a){a[this.selectedAttribute]=!1,a[this.indeterminateAttribute]=!1},o=function(a){a[this.selectedAttribute]=!0,a[this.indeterminateAttribute]=!1},p=function(a){var b=a[this.childrenAttribute],c=this.selectedAttribute,d=this.indeterminateAttribute,e=0,f=0;i.forEach(b,function(a,b){a[c]?e++:a[d]&&f++}),0===e&&0===f?(a[c]=!1,a[d]=!1):e===b.length?(a[c]=!0,a[d]=!1):(a[c]=!1,a[d]=!0)},q=function(a){return i.isString(a)||i.isNumber(a)}},c.$inject=["$document","$element","$timeout","TreeviewOptions"],a.module("wf.angular.tree",["wf.angular.constants"]).component("wfTreeNode",{transclude:!0,templateUrl:"wf/ng-template/tree/treeNode.html",require:{parent:"^^wfTree"},bindings:{label:"<",isSelected:"<",disable:"<?",children:"<",node:"<"},controller:b}).component("wfTree",{transclude:!0,templateUrl:"wf/ng-template/tree/treeView.html",bindings:{treeData:"=",hasCheckbox:"<?",disable:"<?"},controller:c}).directive("uiIndeterminate",[function(){return{compile:function(b,c){return c.type&&"checkbox"===c.type.toLowerCase()?function(a,b,c){a.$watch(c.uiIndeterminate,function(a){b[0].indeterminate=!!a})}:a.noop}}}]).provider("TreeviewOptions",function(){var b={idAttribute:"id",labelAttribute:"label",childrenAttribute:"children",selectedAttribute:"isSelected",expandToDepth:0,useCheckboxes:!0,validate:!0,indeterminateAttribute:"isIndeterminate",expandedAttribute:"isExpend",defaultSelectedState:!0};this.set=function(c){a.extend(b,c)},this.$get=function(){return function(){return a.copy(b)}}})});